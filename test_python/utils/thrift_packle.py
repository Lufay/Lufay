import pickle

def gen_article_key(article_id: str):
    return f':1:done_article_{article_id}'

def get_data(packled_data: str):
    assert packled_data.startswith('0x')
    data_i = int(packled_data, 16)
    b = data_i.to_bytes((data_i.bit_length()+7)//8, 'big')
    return pickle.loads(b)


if __name__ == '__main__':
    print(gen_article_key("7124601131455660805"))

    import sys
    sys.path.append('..') # for service_rpc_idl
    import thriftpy2
    thriftpy2.install_import_hook()
    s = "0x80049515040000000000008c2b736572766963655f7270635f69646c2e636f6e74656e742e626c75655f61726d795f656e5f746872696674948c0f426c756541726d7941727469636c659493942981947d94288c0a61727469636c655f6964948c1337313234363031313331343535363630383035948c096372656174655f7473944a0aabdf628c097570646174655f7473944a353ddf628c0969735f66696e69736894888c086167655f74797065944e8c096c616e677561676573948c027275948c0e6d616368696e655f726573756c74944b018c0c68756d616e5f726573756c74944e8c06737461676573945d9468008c1041727469636c655374616765496e666f9493942981947d94288c0a636f6e6669675f6b6579948c1874696b746f6b5f636f6d6d656e745f626c75655f61726d799468058c1337313234363031313331343535363630383035948c1366696e616c5f7665726966795f726573756c74944b018c0d7665726966795f726573756c74944e8c117265766965775f636f6e6669675f6b6579948c1874696b746f6b5f636f6d6d656e745f626c75655f61726d79948c1166696e616c5f7665726966795f64617461948c797b2273656e7369746976655f776f726473223a205b5d2c2022636d745f726573756c74223a207b22737461747573223a20312c20227265766965775f737461747573223a20302c2022636d745f737461747573223a20322c2022626f6f7374223a20302c2022626f6f73745f726561736f6e223a2022227d7d947562618c0f73656e7369746976655f776f726473948f948c08656c656d656e7473945d942868008c07456c656d656e749493942981947d94288c0474797065944b008c07636f6e74656e74948c1337313132303133363339363336333037323032948c0375726c944e8c03766964944e8c057769647468944e8c06686569676874944e8c086475726174696f6e944e8c046e616d65944e8c03757269944e8c086d696d6574797065944e8c03716964944e8c0473697a65944e8c086d757369635f6964944e8c0a636f6e74656e745f6964948c00948c096672616d655f636e74944e8c06666f726d6174944e8c036d6435944e8c06737461747573944e8c087265766965776564944e8c04726f6c65944e8c0a6669656c645f6e616d65948c076974656d5f696494756268232981947d942868264b0068278c0fd091d0b5d0b720d0bcd0b0d0bcd18b9468294e682a4e682b4e682c4e682d4e682e4e682f4e68304e68314e68324e68334e6834683568364e68374e68384e68394e683a4e683b4e683c8c07636f6d6d656e74947562658c0d7265706f72745f726561736f6e9468358c117265706f727465725f6167655f74797065944b008c117265706f727465645f6167655f74797065944b008c0a636d745f737461747573944b028c076d6973696e666f944e75622e"
    print(get_data(s))

    s = "0x80059506020000000000007D94288C0776657273696F6E944B018C026964948C096669727374206A6F62948C0466756E63948C1568656C707065722E617070733A63726F6E5F6A6F62948C0774726967676572948C1D61707363686564756C65722E74726967676572732E696E74657276616C948C0F496E74657276616C547269676765729493942981947D942868014B028C0874696D657A6F6E65948C1B7079747A5F6465707265636174696F6E5F7368696D2E5F696D706C948C09777261705F7A6F6E659493948C086461746574696D65948C0874696D657A6F6E6594939468108C0974696D6564656C74619493944B004B004B0087945294859452948C0355544394869452948C0A73746172745F646174659468108C086461746574696D65949394430A07E60801081C290AFCC294681B869452948C08656E645F64617465944E8C08696E74657276616C9468144B004B144B00879452948C066A6974746572944E75628C086578656375746F72948C0764656661756C74948C0461726773944B014B024B0387948C066B7761726773947D948C0161948C056170706C6594738C046E616D65948C0863726F6E5F6A6F62948C126D6973666972655F67726163655F74696D65944B018C08636F616C6573636594888C0D6D61785F696E7374616E636573944B018C0D6E6578745F72756E5F74696D6594681E430A07E60801081C290AFCC294681B86945294752E"
    print(get_data(s))